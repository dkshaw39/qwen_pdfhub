<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protect PDF Online - Add Password Protection | PDFPro</title>
    <meta name="description" content="Free online tool to add password protection to PDF files. Secure your PDF documents with passwords - no server uploads, 100% secure.">
    <meta name="keywords" content="protect pdf, password protect pdf, secure pdf, pdf password, add pdf security, pdf encryption">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="logo-container">
                <a href="../index.html">
                    <i class="fas fa-file-pdf logo-icon"></i>
                    <h1>PDFPro</h1>
                </a>
            </div>
            <div class="header-info">
                <div class="privacy-badge">
                    <i class="fas fa-shield-alt"></i>
                    <span>100% Private • No Server Uploads</span>
                </div>
            </div>
        </header>

        <div class="app-content">
            <!-- Sidebar with tools -->
            <nav class="sidebar">
                <div class="sidebar-header">
                    <h3>PDF Tools</h3>
                </div>
                
                <div class="tools-category">
                    <h4><i class="fas fa-folder"></i> Organize PDF</h4>
                    <ul class="tools-list">
                        <li><a href="merge-pdf.html"><i class="fas fa-code-branch"></i> Merge PDF</a></li>
                        <li><a href="split-pdf.html"><i class="fas fa-scissors"></i> Split PDF</a></li>
                        <li><a href="remove-pages.html"><i class="fas fa-trash-alt"></i> Remove pages</a></li>
                        <li><a href="extract-pages.html"><i class="fas fa-file-export"></i> Extract pages</a></li>
                        <li><a href="organize-pdf.html"><i class="fas fa-sort"></i> Organize PDF</a></li>
                        <li><a href="scan-pdf.html"><i class="fas fa-camera"></i> Scan to PDF</a></li>
                    </ul>
                </div>

                <div class="tools-category">
                    <h4><i class="fas fa-bolt"></i> Optimize PDF</h4>
                    <ul class="tools-list">
                        <li><a href="compress-pdf.html"><i class="fas fa-compress"></i> Compress PDF</a></li>
                        <li><a href="repair-pdf.html"><i class="fas fa-wrench"></i> Repair PDF</a></li>
                        <li><a href="ocr-pdf.html"><i class="fas fa-font"></i> OCR PDF</a></li>
                    </ul>
                </div>

                <div class="tools-category">
                    <h4><i class="fas fa-exchange-alt"></i> Convert to PDF</h4>
                    <ul class="tools-list">
                        <li><a href="jpg-to-pdf.html"><i class="fas fa-image"></i> JPG to PDF</a></li>
                        <li><a href="word-to-pdf.html"><i class="fas fa-file-word"></i> WORD to PDF</a></li>
                        <li><a href="ppt-to-pdf.html"><i class="fas fa-file-powerpoint"></i> POWERPOINT to PDF</a></li>
                        <li><a href="excel-to-pdf.html"><i class="fas fa-file-excel"></i> EXCEL to PDF</a></li>
                        <li><a href="html-to-pdf.html"><i class="fas fa-code"></i> HTML to PDF</a></li>
                    </ul>
                </div>

                <div class="tools-category">
                    <h4><i class="fas fa-exchange-alt"></i> Convert from PDF</h4>
                    <ul class="tools-list">
                        <li><a href="pdf-to-jpg.html"><i class="fas fa-image"></i> PDF to JPG</a></li>
                        <li><a href="pdf-to-word.html"><i class="fas fa-file-word"></i> PDF to WORD</a></li>
                        <li><a href="pdf-to-ppt.html"><i class="fas fa-file-powerpoint"></i> PDF to POWERPOINT</a></li>
                        <li><a href="pdf-to-excel.html"><i class="fas fa-file-excel"></i> PDF to EXCEL</a></li>
                        <li><a href="pdf-to-pdfa.html"><i class="fas fa-file-archive"></i> PDF to PDF/A</a></li>
                    </ul>
                </div>

                <div class="tools-category">
                    <h4><i class="fas fa-edit"></i> Edit PDF</h4>
                    <ul class="tools-list">
                        <li><a href="rotate-pdf.html"><i class="fas fa-rotate"></i> Rotate PDF</a></li>
                        <li><a href="add-page-numbers.html"><i class="fas fa-list-ol"></i> Add page numbers</a></li>
                        <li><a href="add-watermark.html"><i class="fas fa-water"></i> Add watermark</a></li>
                        <li><a href="crop-pdf.html"><i class="fas fa-crop"></i> Crop PDF</a></li>
                        <li><a href="edit-pdf.html"><i class="fas fa-edit"></i> Edit PDF</a></li>
                    </ul>
                </div>

                <div class="tools-category">
                    <h4><i class="fas fa-lock"></i> PDF Security</h4>
                    <ul class="tools-list">
                        <li><a href="unlock-pdf.html"><i class="fas fa-unlock"></i> Unlock PDF</a></li>
                        <li class="active"><a href="protect-pdf.html"><i class="fas fa-lock"></i> Protect PDF</a></li>
                        <li><a href="sign-pdf.html"><i class="fas fa-signature"></i> Sign PDF</a></li>
                        <li><a href="redact-pdf.html"><i class="fas fa-redo"></i> Redact PDF</a></li>
                        <li><a href="compare-pdf.html"><i class="fas fa-copy"></i> Compare PDF</a></li>
                    </ul>
                </div>
            </nav>

            <!-- Main content area -->
            <main class="main-content">
                <div class="tool-header">
                    <h2>Protect PDF</h2>
                    <div class="tool-description">
                        <p>Add password protection to PDF files. All processing happens in your browser - your files never leave your computer.</p>
                    </div>
                </div>

                <div class="tool-content">
                    <div class="privacy-notice">
                        <div class="notice-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="notice-content">
                            <h3>Security & Privacy</h3>
                            <ul>
                                <li><strong>No file uploads</strong> - All processing happens in your browser</li>
                                <li><strong>No tracking</strong> - We don't collect any usage data</li>
                                <li><strong>No login required</strong> - Use tools instantly</li>
                                <li><strong>100% free</strong> - No hidden costs or subscriptions</li>
                                <li><strong>Secure processing</strong> - Your documents stay private</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Tool functionality section -->
                    <div class="tool-functionality">
                        <div class="tool-description-section">
                            <h3>About PDF Protection</h3>
                            <p>Adding password protection to PDF files is essential for securing sensitive documents. Our tool allows you to protect your PDF files with strong passwords, preventing unauthorized access to your documents. You can set both user passwords (to open the document) and owner passwords (to control permissions like printing, copying, and editing). This is perfect for sharing confidential documents, contracts, or any sensitive information that needs protection.</p>
                            
                            <h4>How to Protect PDF Files:</h4>
                            <ol>
                                <li>Upload the PDF file you want to protect</li>
                                <li>Enter a password for the PDF in the password field</li>
                                <li>Optionally, enter a separate permission password for advanced restrictions</li>
                                <li>Click "Protect PDF" to add password protection</li>
                                <li>Download the protected PDF when complete</li>
                            </ol>
                            
                            <h4>Security Options Explained:</h4>
                            <ul>
                                <li><strong>User Password</strong>: Required to open the PDF document</li>
                                <li><strong>Owner Password</strong>: Allows full access to the document and its permissions</li>
                                <li><strong>Permission Restrictions</strong>: Control printing, copying, editing, and other document functions</li>
                                <li><strong>Encryption</strong>: Uses strong encryption to protect your documents</li>
                            </ul>
                        </div>
                        
                        <div class="tool-interface">
                            <div class="file-input-section">
                                <label for="protect-pdf-file" class="file-upload-label">
                                    <i class="fas fa-file-pdf"></i>
                                    <span>Select PDF to protect</span>
                                </label>
                                <input type="file" id="protect-pdf-file" accept=".pdf">
                                <div class="security-options">
                                    <label for="user-password">Enter password to open document:
                                        <input type="password" id="user-password" placeholder="Enter user password">
                                    </label>
                                    <label for="owner-password" style="margin-top: 10px;">Enter permission password (optional):
                                        <input type="password" id="owner-password" placeholder="Enter owner password">
                                    </label>
                                </div>
                            </div>
                            <div class="tool-controls">
                                <button id="protect-btn" class="action-btn" disabled>
                                    <i class="fas fa-lock"></i> Protect PDF
                                </button>
                                <button id="download-protected" class="action-btn secondary" style="display:none;">
                                    <i class="fas fa-download"></i> Download Protected PDF
                                </button>
                            </div>
                        </div>
                        
                        <div class="tool-features">
                            <h3>Advanced Features</h3>
                            <div class="features-grid">
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="fas fa-shield-alt"></i>
                                    </div>
                                    <h4>Strong Encryption</h4>
                                    <p>Uses industry-standard encryption to protect your PDF documents</p>
                                </div>
                                
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="fas fa-bolt"></i>
                                    </div>
                                    <h4>Fast Processing</h4>
                                    <p>Quickly protect documents without waiting for server processing</p>
                                </div>
                                
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="fas fa-lock"></i>
                                    </div>
                                    <h4>Secure & Private</h4>
                                    <p>Files never leave your computer, all processing is done locally</p>
                                </div>
                                
                                <div class="feature-card">
                                    <div class="feature-icon">
                                        <i class="fas fa-infinity"></i>
                                    </div>
                                    <h4>Permission Control</h4>
                                    <p>Control printing, copying, editing, and other document permissions</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tool functionality
            let protectFile = null;
            let protectedPdfBytes = null;

            // File input handling
            document.getElementById('protect-pdf-file').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (!file || !file.type.includes('pdf')) {
                    alert('Please select a valid PDF file.');
                    return;
                }

                protectFile = file;
                document.getElementById('protect-btn').disabled = false;

                // Update UI to show selected file
                const fileLabel = document.querySelector('#protect-pdf-file + .file-upload-label span');
                fileLabel.textContent = file.name;
            });

            // Password input handling
            function checkPasswordInputs() {
                const fileSelected = protectFile !== null;
                const userPassword = document.getElementById('user-password').value.trim();
                const hasPassword = userPassword !== '';
                
                document.getElementById('protect-btn').disabled = !(fileSelected && hasPassword);
            }

            document.getElementById('user-password').addEventListener('input', checkPasswordInputs);
            document.getElementById('owner-password').addEventListener('input', checkPasswordInputs);

            // Protect PDF functionality
            document.getElementById('protect-btn').addEventListener('click', async function() {
                if (!protectFile) {
                    alert('Please select a PDF file to protect.');
                    return;
                }

                const userPassword = document.getElementById('user-password').value;
                if (!userPassword) {
                    alert('Please enter a password for the PDF.');
                    return;
                }

                try {
                    // Show processing message
                    const protectBtn = document.getElementById('protect-btn');
                    const originalText = protectBtn.innerHTML;
                    protectBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Protecting...';
                    protectBtn.disabled = true;

                    // Read file as array buffer
                    const arrayBuffer = await protectFile.arrayBuffer();
                    
                    // Load the PDF document
                    const { PDFDocument, StandardFonts, rgb } = window.PDFLib;
                    const pdfDoc = await PDFDocument.load(arrayBuffer);
                    
                    // Create new PDF with password protection
                    const newPdfBytes = await pdfDoc.save({
                        useObjectStreams: false,
                        addDefaultPage: false,
                        objectsPerDocument: 1000,
                        updateFieldAppearances: false,
                    });
                    
                    // Create a new document with encryption
                    const newPdfDoc = await PDFDocument.load(newPdfBytes);
                    const ownerPassword = document.getElementById('owner-password').value || userPassword;
                    
                    // Save with encryption
                    const pdfBytes = await newPdfDoc.save({
                        useObjectStreams: false,
                        addDefaultPage: false,
                        objectsPerDocument: 1000,
                        updateFieldAppearances: false,
                        encrypt: {
                            userPassword: userPassword,
                            ownerPassword: ownerPassword,
                            userPermissions: {
                                printing: 'lowResolution', // Allow low-res printing
                                modifying: false,
                                copying: false,
                                annotating: true,
                                fillingForms: true,
                                contentAccessibility: true,
                                documentAssembly: false,
                                highQualityPrinting: false,
                            }
                        }
                    });

                    // Store the protected PDF for download
                    protectedPdfBytes = pdfBytes;

                    // Enable download button
                    document.getElementById('download-protected').style.display = 'block';

                    // Reset button
                    protectBtn.innerHTML = originalText;
                    protectBtn.disabled = false;

                    // Show success message
                    const fileLabel = document.querySelector('#protect-pdf-file + .file-upload-label span');
                    fileLabel.textContent = `✓ ${protectFile.name} (protected)`;

                } catch (error) {
                    console.error('Error protecting PDF:', error);
                    alert('Error protecting PDF. Please try again.');

                    // Reset button
                    const protectBtn = document.getElementById('protect-btn');
                    protectBtn.innerHTML = '<i class="fas fa-lock"></i> Protect PDF';
                    protectBtn.disabled = false;
                }
            });

            // Download protected PDF
            document.getElementById('download-protected').addEventListener('click', function() {
                if (!protectedPdfBytes) {
                    alert('No protected PDF available to download.');
                    return;
                }

                // Create a blob from the protected PDF bytes
                const blob = new Blob([protectedPdfBytes], { type: 'application/pdf' });

                // Create download link
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'protected-' + protectFile.name;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });
        });
    </script>
</body>
</html>